<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />
    <title>Log In</title>
    <!-- <link rel="stylesheet" href="style.css" /> -->
  </head>
  <body>
    <div class="LoginContainer">
      <h1>Online Shopping Wallet System</h1>
      <div class="username">
        <span>Username: </span>
        <input
          id="username_input"
          type="text"
          placeholder="Only Alphanumeric is allowed"
        />
      </div>

      <div class="password">
        <span>Password: </span>
        <input
          id="password_input"
          type="text"
          placeholder="Enter your password"
        />
      </div>

      <button id="loginBtn">Log in</button><br />

      <div class="register">
        <span>Create an account? </span>
        <button id="registerBtn">Register</button>
      </div>
    </div>

    <script>
      const store = [];
      let active = localStorage.getItem("active");
      document.addEventListener("DOMContentLoaded", () => {
        let temp = JSON.parse(localStorage.getItem("store")) || [];
        temp.forEach((obj) => {
          store.push(obj);
        });

      });

      // Log In page
      const username = document.querySelectorAll("#username_input")[0];
      const password = document.querySelectorAll("#password_input")[0];
      const loginBtn = document.querySelectorAll("#loginBtn")[0];
      const registerBtn = document.querySelectorAll("#registerBtn")[0];

      function isValid(username_input, pass_input) {
        let ok = false;
        store.forEach((obj) => {
          if (obj.username == username_input && obj.password == pass_input) {
            ok = true;
          }
        });
        return ok;
      }

      loginBtn.addEventListener("click", () => {
        const username_input = username.value.trim();
        const pass_input = password.value;
        if (!isValid(username_input, pass_input)) {
          alert("Please provide correct username/password, if you don't have any please register.");
          return;
        }
        // next page link
        alert("Welcome to our online shopping wallet system.");
        active = username_input;
        // console.log(active);
        localStorage.setItem("active", JSON.stringify(active));
        window.location.href = "Wallet Management.html";
      });

      registerBtn.addEventListener("click", () => {
        window.location.href = "register.html";
      });

    </script>
  </body>
</html>